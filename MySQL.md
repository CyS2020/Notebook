### 数据库
1. Mysql存储引擎
- MyIsam  非聚集索引索引MYI和数据MYD分别存放  非事务安全型  支持表锁 
- InnoDB  数据和索引在一个文件中ibd   事务安全型   支持行锁也支持表锁

2. 那些索引
- B+树索引 Hash索引 全文索引
- 密集索引: 数据库中的每个搜索键值都有一个索引记录。索引记录包含搜索键值和指向磁盘上实际记录的指针。
- 稀疏索引: 不会为每个搜索关键字创建索引记录。我们首先按索引记录进行操作，然后到达数据的实际位置。
           如果我们要寻找的数据不是我们通过遵循索引直接到达的位置，那么系统将开始顺序搜索，直到找到所需的数据为止。
- 聚集索引: 通过每张表的主键顺序进行存放，其叶子节点存放的是这张表的每行完整数据。也正是我们有时称呼的主键索引(对比一下稠密索引)
- 非聚集索引: (辅助索引，二级索引)其叶子节点并不包含行记录的全部数据，其叶子结点的数据包含辅助索引(key)和主键索引(value)

3. InnoDB
- 若主键被定义则主键即为密集索引，叶子节点存放的是这张表的每行完整数据
- 若未定义主键，则该表的第一个唯一索引则作为密集索引
- 若不满足上述条件，InnoDB内部会生成一个隐藏主键
- 非主键索引(稀疏索引)，叶子节点存储相关键位和对应的主键值，包含两次查找
 
4. 如何定位并优化慢查询
- 根据慢日志查询慢日志sql
- 使用explain等分析工具，type(index、all全表扫描)，extra(Using filesort、Using temporary)
- 修改sql或者尽量让sql走索引 

5. 联合索引的最左前缀匹配原则
- mysql会一直向右匹配知道遇到范围查询(>、<、between、like)就停止匹配
- =和in可以乱序，mysql查询优化器会帮你优化成可以识别的形式

6. 索引不是越多越好
- 数据量小的表不需要建立索引，建立会增加额外的索引开销
- 数据变更需要维护索引，因此更多的索引意味着更多的维护成本
- 更多的索引意味着也需要更多的空间

7. InnoDB锁两阶段锁
- 事务里面，分为加锁(lock)阶段和解锁(unlock)阶段,也即所有的lock操作都在unlock操作之前
- 在事务中只有提交(commit)或者回滚(rollback)时才是解锁阶段，其余时间为加锁阶段。
- 当不走索引的时候整张表都会被锁住，此时查询使用的是表级锁，


|MyIsam|InnoDb|
| --- | --- |
|频繁执行全表count||
|对数据增删改的频率不高，查询非常高|数据增删改查都相当频繁|
|没有事务|可靠性比较高，支持事务|

8. 锁分类
- 按照粒度划分：表级锁，行级锁，页级锁
- 按锁级别划分：共享锁，排它锁
- 按加锁方式分：自动锁，显示锁
- 按照操作划分：DML锁，DDL锁
- 按使用方式分：乐观锁，悲观锁