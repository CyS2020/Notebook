## TCP/IP基础知识

### 1. TCP/IP具体含义

-   TCP/IP是利用IP进行通信时所需要的协议群的统称。有时也称TCP/IP网际协议族

    ![TCP/IP协议群]()

### 2. 互联网与TCP/IP的关系

-   互联网进行通信时，需要相应的网际协议，TCP/IP就是为使用互联网而开发指定的协议族
-   互联网的协议就是TCP/IP，TCP/IP就是互联网的协议

### 3. TCP/IP与OSI参考模型

-   ​    应用层                        /               FTP、POP3/SMTP、HTTP/HTTPS、SNMP、TELNET/SSH

    ​    表示层                   应用层          			   SSL、HTML、MIME、MIB

    ​    会话层                        /

    ​    传输层                   传输层                                   TCP、UPD

    ​    网络层                   网络层                               IP、ICMP、ARP

    数据链路层               链路层

    ​    物理层                       /

### 4. 表述数据的单位

-   包：全能性术语
-   帧：用来表述数据链路层的包的单位
-   数据报：IP和UDP等网络层以上的分层中的包的单位
-   段：表示TCP数据流中的信息
-   消息：协议中数据的单位

### 5. 经过数据链路的包

-   每层至少包含：发送端接收端地址，上一层的协议类型

    ![分层中包的结构]()

### 6. 物流类比通信各层

-   淘宝买卖双方交易属于应用层与传输层部分

-   卖家使用邮政寄送，全国各个邮政网点属于网络层，规划寄送各个转发网点
-   连接两个网点可以飞机直达，铁路运输，公路运输即为链路层
-   那些飞机航道，铁路线，公路线即为物理层

### 7. 数据链路相关技术

-   **MAC地址**：媒体访问控制地址：局域网地址、以太网地址、物理地址，用来确认网络设备位置的地址

    MAC地址用于网络中唯一标示一个网卡，一台设备若有多个网卡则每个网卡都会有一个唯一的MAC地址

    只要不同属于一个数据链路可以不唯一，使用虚拟机软件虚拟的网卡很难保证唯一性

    ![MAC地址格式]()

-   共享介质型网络：有两种介质访问控制方式：**争用方式** -> 也叫CSMA(载波侦听多路访问)，采用先到先得的方式占用信道发送数据，如果多个站同时发送帧，则会产生冲突现象，一部分以太网改良了CSMA/CD(冲突检测)的方式提前检查冲突。**令牌传递方式** -> 只要令牌获得的站才能发送数据一是不会冲突二是每个站平等循环获得机会，缺点是不拥堵的情况利用率也打不到100%

-   非共享介质网络：网络中每个站都直连交换机，由交换机负责转发数据帧，多数情况下采用全双工通信，一旦交换机发生故障与之相连的所有计算机之间将无法通信。ATM采用这种传输控制方式，也逐渐成为**以太网的主流方式**

-   根据MAC地址转发：交换机就是只有持有多个端口N * (N - 1) 的网桥**（** 是连接两个局域网的一种存储/转发设备，它能将一个大的LAN分割为多个网段，或将两个以上的LAN互联为一个逻辑LAN，使LAN上的所有用户都可访问服务器 **）**的集合，根据数据链路帧的目标MAC地址，决定从哪个网络接口发送数据。参考的表为转发表，由交换机自学得到。

    ![交换机自学原理]()

-   交换机转发方式：**存储转发** -> 检查以太网数据帧末尾的FCS-帧检验序列位后进行转发，避免由冲突、噪音导致的错误帧。**直通转发** -> 知道目标即可开始转发，延迟较小可能有发送错误帧的可能。FCS中保存着整个帧除以生成多项式的余数由CRC计算(**循环冗余校验**)

-   环路检测技术：**生成树方式** -> 通过交换BPDU包判断哪些端口使用哪些不使用，发送故障切换线路利用不使用的端口继续传输，切换时间长。**源路由法** -> 发送端具有源路由功能

-   **VLAN**：用于分散网络负载、交换部署网络设置的位置等情况，无需修改实际的网络布线，只需修改网络结构

    交换机按照其端口区分了多个网段，从而区分了广播数据的传播范围、减少了网络负载并提高了安全性

    ![简单的VLAN]()

    异构的两个网段之间，就需要具有路由功能的交换机(或者各段中间通过路由器的连接才能实现通信)，TAG VLAN中对每个网段都用一个VLAN ID的标签进行唯一标识，允许包含跨异构交换机的网段。

    ![跨越交换机的VLAN]()

### 8. 以太网

-   在众多数据链路中最为著名、使用最为广泛的莫过于以太网，规范简单易于网卡及驱动程序实现。以太网已成为最具兼容性和与未来发展性的一种数据链路。（局域网-交通网；以太网-铁路网）

-   以太网帧的格式

    以太网前端有前导码的部分8个字节，前导码末尾是一个叫SFD的域，它的值为11，域后就是以太网帧的本体

    ![以太网帧的前导码]()

    以太网帧前端是以太网首部，共14字节，帧头后是数据，所能容纳最大数据范围是46~1500字节，帧尾是FCS

    ![以太网帧格式]()

### 9. 无线通信

|   分类   |     通讯距离      |  相关技术  |
| :------: | :---------------: | :--------: |
| 无线 PAN |     10米左右      |    蓝牙    |
| 无线 LAN |     100米左右     |   Wi-Fi    |
| 无线 MAN | 数千米 ~ 100千米  |   WiMAX    |
| 无线 RAN | 200千米 ~ 700千米 |     -      |
| 无线 WAN |         -         | 3G、4G、5G |

### 10. 其他数据链路

-   PPP：一对一连接电脑协议，相当于OSI模型数据链路层与物理层无关。可以使用电话线、ISND、专线

    PPP中包括两个协议：不依赖上层的LCP协议，依赖上层的NCP协议如果上层为IP则此时NCP也称IPCP

    **LCP**主要负责建立和断开连接、设置最大接收单元、设置验证协议(PAP或CHAP)

    **IPCP**负责IP地址设置以及是否进行TCP/IP首部压缩等设置

    通过PPP连接时，需要进行用户名密码的验证，并且对通信两端进行双向验证。验证协议为PAP、CHAP

    ![PPP中建立连接]()

    **PAP**是PPP连接建立时，两次握手进行用户名和密码的验证，密码用明文传输。用于安全要求不高的环境

    **CHPA**则使用一次性密码，可以有效防止窃听，建立连接后可以定期密码交换。检验对端是否中途被替换

    **PPPoE**拨号上网采用PPPoE管理以太网连接，就可以利用PPP的验证功能。各家ISP可以有效的管理终端

-   POS：是一种在SDH上进行包通信的协议。SDH是在光纤上传输数字信号的规范

-   HDMI：意为高清晰度多媒体接口，通过一根缆线实现图像和声音等数字信号的高品质传输

### 11. 使用PPPoE协议的上网方式

-   ADSL：使用电话线 + 猫，附加一个分离器将音频信号与数字信号隔离以免产生噪声干扰，应用最为广泛

    ![ADSL连接]()

-   FTTH：使用光纤 + 光猫，通过ONU-光网络单元(光猫是一种)负责光信号与电子信号转换，极具发展前景

    ![FTTH连接]()

-   有线电视：使用同轴电缆 + 有线猫，电视台 -> 住宅用与电视播送相同频率带宽，住宅 -> 电视台使用未使用的低频带宽，传输数据上行速度低于下行速度

    ![有限电视连接]()

    **注释**：总结下拨号上网过程

    -   电脑发出数字信号，“  **猫**  ”把数字信号变为所需信号
    -   猫顺着线(电话线，光纤，同轴电缆)将信号传给ISP，猫上ISP内网了
    -   ISP将数字信号转发，猫上互联网了

-   VPN：虚拟专用网络用于连接距离较远的地域。这种服务包括IP-VPN和广域以太网

    **IP-VPN**意指在IP网络(互联网)上建立VPN服务商提供MPLS技术构建VPN服务，还能进行用户级别带宽控制

    **企业级VPN**公司内网搭建一个VPN服务器，外地员工访问时通过VPN服务器进入企业内网，VPN服务器和客户机之间采用IPsec技术对IP包进行验证和加密，好像数据在一条专用的数据链路上安全传输。实际VPN使用的是互联网上的公共链路。实质上就是利用加密技术在互联网上封装一个数据通讯隧道。

    **广域以太网**则是在作为数据链路层的以太网上利用VLAN实现VPN技术。广域以太网主要形式为服务提供商所构建的VLAN网，只要指定同一个VLAN无论哪里都能接入到同一个网络。

-   移动通信服务(商用牌照)

    CDMA2000：中国电信3G网络模式

    TD-SCDMA：中国移动3G网络模式

    WCDMA：中国联通3G网络模式

    TD-LTE：中国移动4G网络模式

    FDD-LTE：中国电信联通的4G网络模式

    **Release16**：全球5G网络模式(暂定还在进行中)

### 小结

-   聊到现在的**网络**、**链路**、**MAC地址转发**、**局域网**、其实本质上是指一个小范围的局域网，我们都是讨论局域网内，信息是如何传播的。实现局域网的方式有很多**以太网**就是最常见最广泛的方式，所谓以太网实现就是在描述我们应该怎么这么多主机联络在一起构成一个局域网。双绞线 + 交换机是以太网展现给我的具体形态，总而言之就是用网线连在一起了。